package tpb.outbound.driver.init;

import java.io.IOException;
import java.lang.reflect.Modifier;
import java.util.List;

import tpb.lib.cache.Cache;
import tpb.lib.cache.CacheManager;
import tpb.lib.constant.CacheConstant;
import tpb.lib.init.BaseInit;
import tpb.lib.util.FileUtil;
import tpb.lib.util.ResourceUtil;
import tpb.outbound.common.constant.ParamConstant;
import tpb.outbound.common.dto.request.BaseRequestDto;

public class RequestDtoInit extends BaseInit {

	@SuppressWarnings("rawtypes")
	@Override
	public void init() throws ClassNotFoundException, IOException, InstantiationException, IllegalAccessException {
		String dtoPackage = ParamConstant.DTO_PACKAGE;
		Cache literalRequestClassCache = (Cache) CacheManager.getInstance().createCache(CacheConstant.LITERAL_REQUEST_CLASS);
		List<Class> initLiteralList = FileUtil.getClasses(dtoPackage, BaseRequestDto.class);
		for(Class literal : initLiteralList) {
			if (Modifier.isAbstract(literal.getModifiers())
					|| Modifier.isInterface(literal.getModifiers())) {
				continue;
			}
			literalRequestClassCache.put(ResourceUtil.getUrlPatternConfigurationByRequestName(literal.getSimpleName()), literal);
		}
		ResourceUtil.clearRequestUrlPatternConfiguratione();
	}

	@Override
	public void destroy() {
		
	}
}
